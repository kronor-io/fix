{-# LANGUAGE DeriveGeneric #-}
{-# LANGUAGE DerivingStrategies #-}
{-# LANGUAGE MultiParamTypeClasses #-}
{-# LANGUAGE RecordWildCards #-}
{-# LANGUAGE TypeFamilies #-}
{-# OPTIONS_GHC -Wno-unused-imports #-}

-- | This module has been GENERATED by fix-codegen.
-- Any manual edits will be undone the next time fix-codegen is run.
module FIX.Groups.OrderAttributeGroupElem where

import Data.List.NonEmpty (NonEmpty)
import Data.Proxy
import Data.Validity
import FIX.Components.Class
import FIX.Fields.MsgType
import FIX.Fields.NoOrderAttribute
import FIX.Fields.OrderAttributeType
import FIX.Fields.OrderAttributeValue
import FIX.Groups.Class
import GHC.Generics (Generic)

-- | GroupSpec
--   { groupName = "NoOrderAttribute"
--   , groupNumberField = "NoOrderAttribute"
--   , groupPieces =
--       [ MessagePieceField "OrderAttributeType" True
--       , MessagePieceField "OrderAttributeValue" False
--       ]
--   }
data OrderAttributeGroupElem = OrderAttributeGroupElem
  { orderAttributeGroupElemOrderAttributeType :: !OrderAttributeType,
    orderAttributeGroupElemOrderAttributeValue :: !(Maybe OrderAttributeValue)
  }
  deriving stock (Show, Eq, Generic)

instance Validity OrderAttributeGroupElem

instance IsComponent OrderAttributeGroupElem where
  toComponentFields ((OrderAttributeGroupElem {..})) =
    mconcat
      [ requiredFieldB orderAttributeGroupElemOrderAttributeType,
        optionalFieldB orderAttributeGroupElemOrderAttributeValue
      ]
  fromComponentFields = do
    orderAttributeGroupElemOrderAttributeType <- requiredFieldP
    orderAttributeGroupElemOrderAttributeValue <- optionalFieldP
    pure (OrderAttributeGroupElem {..})

instance IsGroupElement OrderAttributeGroupElem where
  type GroupNumField OrderAttributeGroupElem = NoOrderAttribute
  mkGroupNum Proxy = NoOrderAttribute
  countGroupNum Proxy = unNoOrderAttribute

makeOrderAttributeGroupElem :: OrderAttributeType -> OrderAttributeGroupElem
makeOrderAttributeGroupElem orderAttributeGroupElemOrderAttributeType =
  let orderAttributeGroupElemOrderAttributeValue = Nothing
   in (OrderAttributeGroupElem {..})
