{-# LANGUAGE DeriveGeneric #-}
{-# LANGUAGE DerivingStrategies #-}
{-# LANGUAGE MultiParamTypeClasses #-}
{-# LANGUAGE RecordWildCards #-}
{-# LANGUAGE TypeFamilies #-}
{-# OPTIONS_GHC -Wno-unused-imports #-}

-- | This module has been GENERATED by fix-codegen.
-- Any manual edits will be undone the next time fix-codegen is run.
module FIX.Groups.QuotReqGrpGroupElem where

import Data.List.NonEmpty (NonEmpty)
import Data.Proxy
import Data.Validity
import FIX.Components.Class
import FIX.Fields.Account
import FIX.Fields.Currency
import FIX.Fields.ExpireTime
import FIX.Fields.Issuer
import FIX.Fields.MaturityDate
import FIX.Fields.MaturityDate2
import FIX.Fields.MsgType
import FIX.Fields.NoRelatedSym
import FIX.Fields.OrderQty
import FIX.Fields.OrderQty2
import FIX.Fields.QuoteType
import FIX.Fields.SettlDate
import FIX.Fields.SettlDate2
import FIX.Fields.Side
import FIX.Fields.Symbol
import FIX.Groups.AllocsGroupElem
import FIX.Groups.Class
import FIX.Groups.QuotReqLegsGrpGroupElem
import GHC.Generics (Generic)

-- | GroupSpec
--   { groupName = "QuotReqGrp"
--   , groupNumberField = "NoRelatedSym"
--   , groupPieces =
--       [ MessagePieceField "Symbol" True
--       , MessagePieceField "MaturityDate" False
--       , MessagePieceField "MaturityDate2" False
--       , MessagePieceField "Issuer" False
--       , MessagePieceField "QuoteType" True
--       , MessagePieceField "Side" False
--       , MessagePieceField "OrderQty" True
--       , MessagePieceField "SettlDate" True
--       , MessagePieceField "SettlDate2" False
--       , MessagePieceField "OrderQty2" False
--       , MessagePieceField "Currency" False
--       , MessagePieceField "Account" True
--       , MessagePieceField "ExpireTime" False
--       , MessagePieceGroup
--           GroupSpec
--             { groupName = "NoAllocs"
--             , groupNumberField = "NoAllocs"
--             , groupPieces =
--                 [ MessagePieceField "AllocAccount" True
--                 , MessagePieceField "AllocQty" True
--                 , MessagePieceGroup
--                     GroupSpec
--                       { groupName = "NoNestedPartyIDs"
--                       , groupNumberField = "NoNestedPartyIDs"
--                       , groupPieces =
--                           [ MessagePieceField "NestedPartyID" True
--                           , MessagePieceField "NestedPartyIDSource" False
--                           , MessagePieceField "NestedPartyRole" False
--                           , MessagePieceField "NestedPartyRoleQualifier" False
--                           ]
--                       }
--                     False
--                 ]
--             }
--           False
--       , MessagePieceGroup
--           GroupSpec
--             { groupName = "QuotReqLegsGrp"
--             , groupNumberField = "NoLegs"
--             , groupPieces =
--                 [ MessagePieceField "LegSymbol" True
--                 , MessagePieceField "LegMaturityDate" False
--                 , MessagePieceField "LegSide" True
--                 , MessagePieceField "LegQty" True
--                 , MessagePieceGroup
--                     GroupSpec
--                       { groupName = "NoLegAllocs"
--                       , groupNumberField = "NoLegAllocs"
--                       , groupPieces =
--                           [ MessagePieceField "LegAllocAccount" True
--                           , MessagePieceField "LegAllocQty" True
--                           , MessagePieceGroup
--                               GroupSpec
--                                 { groupName = "NoNestedPartyIDs"
--                                 , groupNumberField = "NoNestedPartyIDs"
--                                 , groupPieces =
--                                     [ MessagePieceField "NestedPartyID" True
--                                     , MessagePieceField "NestedPartyIDSource" False
--                                     , MessagePieceField "NestedPartyRole" False
--                                     , MessagePieceField "NestedPartyRoleQualifier" False
--                                     ]
--                                 }
--                               False
--                           ]
--                       }
--                     True
--                 , MessagePieceField "LegRefID" True
--                 , MessagePieceField "LegSettlDate" True
--                 ]
--             }
--           False
--       ]
--   }
data QuotReqGrpGroupElem = QuotReqGrpGroupElem
  { quotReqGrpGroupElemSymbol :: !Symbol,
    quotReqGrpGroupElemMaturityDate :: !(Maybe MaturityDate),
    quotReqGrpGroupElemMaturityDate2 :: !(Maybe MaturityDate2),
    quotReqGrpGroupElemIssuer :: !(Maybe Issuer),
    quotReqGrpGroupElemQuoteType :: !QuoteType,
    quotReqGrpGroupElemSide :: !(Maybe Side),
    quotReqGrpGroupElemOrderQty :: !OrderQty,
    quotReqGrpGroupElemSettlDate :: !SettlDate,
    quotReqGrpGroupElemSettlDate2 :: !(Maybe SettlDate2),
    quotReqGrpGroupElemOrderQty2 :: !(Maybe OrderQty2),
    quotReqGrpGroupElemCurrency :: !(Maybe Currency),
    quotReqGrpGroupElemAccount :: !Account,
    quotReqGrpGroupElemExpireTime :: !(Maybe ExpireTime),
    quotReqGrpGroupElemAllocsGroup :: ![AllocsGroupElem],
    quotReqGrpGroupElemQuotReqLegsGrpGroup :: ![QuotReqLegsGrpGroupElem]
  }
  deriving stock (Show, Eq, Generic)

instance Validity QuotReqGrpGroupElem

instance IsComponent QuotReqGrpGroupElem where
  toComponentFields ((QuotReqGrpGroupElem {..})) =
    mconcat
      [ requiredFieldB quotReqGrpGroupElemSymbol,
        optionalFieldB quotReqGrpGroupElemMaturityDate,
        optionalFieldB quotReqGrpGroupElemMaturityDate2,
        optionalFieldB quotReqGrpGroupElemIssuer,
        requiredFieldB quotReqGrpGroupElemQuoteType,
        optionalFieldB quotReqGrpGroupElemSide,
        requiredFieldB quotReqGrpGroupElemOrderQty,
        requiredFieldB quotReqGrpGroupElemSettlDate,
        optionalFieldB quotReqGrpGroupElemSettlDate2,
        optionalFieldB quotReqGrpGroupElemOrderQty2,
        optionalFieldB quotReqGrpGroupElemCurrency,
        requiredFieldB quotReqGrpGroupElemAccount,
        optionalFieldB quotReqGrpGroupElemExpireTime,
        optionalGroupB quotReqGrpGroupElemAllocsGroup,
        optionalGroupB quotReqGrpGroupElemQuotReqLegsGrpGroup
      ]
  fromComponentFields = do
    quotReqGrpGroupElemSymbol <- requiredFieldP
    quotReqGrpGroupElemMaturityDate <- optionalFieldP
    quotReqGrpGroupElemMaturityDate2 <- optionalFieldP
    quotReqGrpGroupElemIssuer <- optionalFieldP
    quotReqGrpGroupElemQuoteType <- requiredFieldP
    quotReqGrpGroupElemSide <- optionalFieldP
    quotReqGrpGroupElemOrderQty <- requiredFieldP
    quotReqGrpGroupElemSettlDate <- requiredFieldP
    quotReqGrpGroupElemSettlDate2 <- optionalFieldP
    quotReqGrpGroupElemOrderQty2 <- optionalFieldP
    quotReqGrpGroupElemCurrency <- optionalFieldP
    quotReqGrpGroupElemAccount <- requiredFieldP
    quotReqGrpGroupElemExpireTime <- optionalFieldP
    quotReqGrpGroupElemAllocsGroup <- optionalGroupP
    quotReqGrpGroupElemQuotReqLegsGrpGroup <- optionalGroupP
    pure (QuotReqGrpGroupElem {..})

instance IsGroupElement QuotReqGrpGroupElem where
  type GroupNumField QuotReqGrpGroupElem = NoRelatedSym
  mkGroupNum Proxy = NoRelatedSym
  countGroupNum Proxy = unNoRelatedSym

makeQuotReqGrpGroupElem :: Symbol -> (QuoteType -> (OrderQty -> (SettlDate -> (Account -> QuotReqGrpGroupElem))))
makeQuotReqGrpGroupElem quotReqGrpGroupElemSymbol quotReqGrpGroupElemQuoteType quotReqGrpGroupElemOrderQty quotReqGrpGroupElemSettlDate quotReqGrpGroupElemAccount =
  let quotReqGrpGroupElemMaturityDate = Nothing
      quotReqGrpGroupElemMaturityDate2 = Nothing
      quotReqGrpGroupElemIssuer = Nothing
      quotReqGrpGroupElemSide = Nothing
      quotReqGrpGroupElemSettlDate2 = Nothing
      quotReqGrpGroupElemOrderQty2 = Nothing
      quotReqGrpGroupElemCurrency = Nothing
      quotReqGrpGroupElemExpireTime = Nothing
      quotReqGrpGroupElemAllocsGroup = []
      quotReqGrpGroupElemQuotReqLegsGrpGroup = []
   in (QuotReqGrpGroupElem {..})
