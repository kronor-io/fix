{-# LANGUAGE DeriveGeneric #-}
{-# LANGUAGE DerivingStrategies #-}
{-# LANGUAGE MultiParamTypeClasses #-}
{-# LANGUAGE RecordWildCards #-}
{-# OPTIONS_GHC -Wno-unused-imports #-}

-- | This module has been GENERATED by fix-codegen.
-- Any manual edits will be undone the next time fix-codegen is run.
module FIX.Messages.QuoteRequest where

import Data.List.NonEmpty (NonEmpty)
import Data.Proxy
import Data.Validity
import FIX.Components.Class
import FIX.Fields.AvgPxPrecision
import FIX.Fields.ClOrdID
import FIX.Fields.DayCount
import FIX.Fields.EncodedText
import FIX.Fields.ExecutionVenueType
import FIX.Fields.ExpireTime
import FIX.Fields.FarLegRatePrecision
import FIX.Fields.Fiduciary
import FIX.Fields.FixingReference
import FIX.Fields.ForwardPointsPrecision
import FIX.Fields.ForwardRatePrecision
import FIX.Fields.InterestRatePrecision
import FIX.Fields.LastCapacity
import FIX.Fields.MsgType
import FIX.Fields.NearLegRatePrecision
import FIX.Fields.OptionDate
import FIX.Fields.OrdType
import FIX.Fields.OrderCapacity
import FIX.Fields.ProductType
import FIX.Fields.QuoteReqID
import FIX.Fields.RFQReqID
import FIX.Fields.RefSpotDate
import FIX.Fields.SpotRatePrecision
import FIX.Fields.Text
import FIX.Groups.Class
import FIX.Groups.QuoteRequestCustomFieldsGroupElem
import FIX.Groups.QuoteRequestOrderAttributesGroupElem
import FIX.Groups.QuoteRequestPartiesGroupElem
import FIX.Groups.QuoteRequestRegulatoryTradeIDsGroupElem
import FIX.Groups.QuoteRequestRelatedSymGroupElem
import FIX.Messages.Class
import GHC.Generics (Generic)

-- | MessageSpec
--   { messageName = "QuoteRequest"
--   , messageType = "R"
--   , messageCategory = "app"
--   , messagePieces =
--       [ MessagePieceField "QuoteReqID" True
--       , MessagePieceGroup
--           GroupSpec
--             { groupName = "QuoteRequestRelatedSym"
--             , groupNumberField = "NoRelatedSym"
--             , groupPieces =
--                 [ MessagePieceComponent "Instrument" True
--                 , MessagePieceComponent "FinancingDetails" True
--                 , MessagePieceField "PrevClosePx" False
--                 , MessagePieceField "QuoteRequestType" False
--                 , MessagePieceField "QuoteType" True
--                 , MessagePieceField "TradingSessionID" False
--                 , MessagePieceField "TradingSessionSubID" False
--                 , MessagePieceField "TradeOriginationDate" False
--                 , MessagePieceField "Side" False
--                 , MessagePieceField "QtyType" False
--                 , MessagePieceComponent "OrderQtyData" False
--                 , MessagePieceField "SettlType" False
--                 , MessagePieceField "SettlDate" False
--                 , MessagePieceField "SplitSettlDate" False
--                 , MessagePieceField "SettlDate2" False
--                 , MessagePieceField "SplitSettlDate2" False
--                 , MessagePieceField "OrderQty2" False
--                 , MessagePieceField "Currency" False
--                 , MessagePieceGroup
--                     GroupSpec
--                       { groupName = "QuoteRequestRelatedSymStipulations"
--                       , groupNumberField = "NoStipulations"
--                       , groupPieces =
--                           [ MessagePieceField "StipulationType" True
--                           , MessagePieceField "StipulationValue" False
--                           ]
--                       }
--                     False
--                 , MessagePieceField "Account" True
--                 , MessagePieceField "AcctIDSource" False
--                 , MessagePieceField "AccountType" False
--                 , MessagePieceGroup
--                     GroupSpec
--                       { groupName = "QuoteRequestRelatedSymQuoteQualifiers"
--                       , groupNumberField = "NoQuoteQualifiers"
--                       , groupPieces = [ MessagePieceField "QuoteQualifier" True ]
--                       }
--                     False
--                 , MessagePieceField "QuotePriceType" False
--                 , MessagePieceField "OrdType" False
--                 , MessagePieceField "ValidUntilTime" False
--                 , MessagePieceField "ExpireTime" False
--                 , MessagePieceField "TransactTime" False
--                 , MessagePieceComponent "SpreadOrBenchmarkCurveData" True
--                 , MessagePieceField "PriceType" False
--                 , MessagePieceField "Price" False
--                 , MessagePieceField "Price2" False
--                 , MessagePieceComponent "YieldData" True
--                 , MessagePieceGroup
--                     GroupSpec
--                       { groupName = "QuoteRequestRelatedSymAllocs"
--                       , groupNumberField = "NoAllocs"
--                       , groupPieces =
--                           [ MessagePieceField "AllocAccount" True
--                           , MessagePieceField "AllocQty" True
--                           ]
--                       }
--                     False
--                 , MessagePieceGroup
--                     GroupSpec
--                       { groupName = "QuoteRequestRelatedSymLegs"
--                       , groupNumberField = "NoLegs"
--                       , groupPieces =
--                           [ MessagePieceField "LegSymbol" True
--                           , MessagePieceField "LegMaturityDate" False
--                           , MessagePieceField "LegSide" True
--                           , MessagePieceField "LegQty" True
--                           , MessagePieceGroup
--                               GroupSpec
--                                 { groupName = "QuoteRequestRelatedSymLegsLegAllocs"
--                                 , groupNumberField = "NoLegAllocs"
--                                 , groupPieces =
--                                     [ MessagePieceField "LegAllocAccount" True
--                                     , MessagePieceField "LegAllocQty" True
--                                     , MessagePieceGroup
--                                         GroupSpec
--                                           { groupName =
--                                               "QuoteRequestRelatedSymLegsLegAllocsNestedParties"
--                                           , groupNumberField = "NoNestedPartyIDs"
--                                           , groupPieces =
--                                               [ MessagePieceField "NestedPartyID" True
--                                               , MessagePieceField "NestedPartyIDSource" False
--                                               , MessagePieceField "NestedPartyRole" False
--                                               , MessagePieceField "NestedPartyRoleQualifier" False
--                                               , MessagePieceGroup
--                                                   GroupSpec
--                                                     { groupName =
--                                                         "QuoteRequestRelatedSymLegsLegAllocsNestedPartiesNestedPartySubIDs"
--                                                     , groupNumberField = "NoNestedPartySubIDs"
--                                                     , groupPieces =
--                                                         [ MessagePieceField "NestedPartySubID" True
--                                                         , MessagePieceField
--                                                             "NestedPartySubIDType" False
--                                                         ]
--                                                     }
--                                                   False
--                                               ]
--                                           }
--                                         False
--                                     ]
--                                 }
--                               True
--                           , MessagePieceField "LegRefID" True
--                           , MessagePieceField "LegSettlDate" True
--                           , MessagePieceField "LegSplitSettlDate" False
--                           ]
--                       }
--                     False
--                 ]
--             }
--           True
--       , MessagePieceField "RFQReqID" False
--       , MessagePieceField "ClOrdID" False
--       , MessagePieceField "OrderCapacity" False
--       , MessagePieceGroup
--           GroupSpec
--             { groupName = "QuoteRequestParties"
--             , groupNumberField = "NoPartyIDs"
--             , groupPieces =
--                 [ MessagePieceField "PartyID" True
--                 , MessagePieceField "PartyIDSource" False
--                 , MessagePieceField "PartyRole" False
--                 , MessagePieceField "PartyRoleQualifier" False
--                 , MessagePieceGroup
--                     GroupSpec
--                       { groupName = "QuoteRequestPartiesPartySubIDs"
--                       , groupNumberField = "NoPartySubIDs"
--                       , groupPieces =
--                           [ MessagePieceField "PartySubID" True
--                           , MessagePieceField "PartySubIDType" False
--                           ]
--                       }
--                     False
--                 ]
--             }
--           False
--       , MessagePieceGroup
--           GroupSpec
--             { groupName = "QuoteRequestRegulatoryTradeIDs"
--             , groupNumberField = "NoRegulatoryTradeIDs"
--             , groupPieces =
--                 [ MessagePieceField "RegulatoryTradeID" True
--                 , MessagePieceField "RegulatoryTradeIDType" False
--                 ]
--             }
--           False
--       , MessagePieceGroup
--           GroupSpec
--             { groupName = "QuoteRequestOrderAttributes"
--             , groupNumberField = "NoOrderAttributes"
--             , groupPieces =
--                 [ MessagePieceField "OrderAttributeType" True
--                 , MessagePieceField "OrderAttributeValue" False
--                 ]
--             }
--           False
--       , MessagePieceField "OptionDate" False
--       , MessagePieceField "Text" False
--       , MessagePieceField "EncodedText" False
--       , MessagePieceField "RefSpotDate" False
--       , MessagePieceField "ProductType" True
--       , MessagePieceField "ExecutionVenueType" False
--       , MessagePieceField "LastCapacity" False
--       , MessagePieceField "DayCount" False
--       , MessagePieceField "FixingReference" False
--       , MessagePieceField "AvgPxPrecision" False
--       , MessagePieceField "ExpireTime" False
--       , MessagePieceField "Fiduciary" False
--       , MessagePieceField "OrdType" False
--       , MessagePieceField "SpotRatePrecision" False
--       , MessagePieceField "ForwardRatePrecision" False
--       , MessagePieceField "ForwardPointsPrecision" False
--       , MessagePieceField "InterestRatePrecision" False
--       , MessagePieceField "NearLegRatePrecision" False
--       , MessagePieceField "FarLegRatePrecision" False
--       , MessagePieceGroup
--           GroupSpec
--             { groupName = "QuoteRequestCustomFields"
--             , groupNumberField = "NoCustomFields"
--             , groupPieces =
--                 [ MessagePieceField "CustomFieldsName" True
--                 , MessagePieceField "CustomFieldsValue" True
--                 ]
--             }
--           False
--       ]
--   }
data QuoteRequest = QuoteRequest
  { quoteRequestQuoteReqID :: !QuoteReqID,
    quoteRequestQuoteRequestRelatedSymGroup :: !(NonEmpty QuoteRequestRelatedSymGroupElem),
    quoteRequestRFQReqID :: !(Maybe RFQReqID),
    quoteRequestClOrdID :: !(Maybe ClOrdID),
    quoteRequestOrderCapacity :: !(Maybe OrderCapacity),
    quoteRequestQuoteRequestPartiesGroup :: ![QuoteRequestPartiesGroupElem],
    quoteRequestQuoteRequestRegulatoryTradeIDsGroup :: ![QuoteRequestRegulatoryTradeIDsGroupElem],
    quoteRequestQuoteRequestOrderAttributesGroup :: ![QuoteRequestOrderAttributesGroupElem],
    quoteRequestOptionDate :: !(Maybe OptionDate),
    quoteRequestText :: !(Maybe Text),
    quoteRequestEncodedText :: !(Maybe EncodedText),
    quoteRequestRefSpotDate :: !(Maybe RefSpotDate),
    quoteRequestProductType :: !ProductType,
    quoteRequestExecutionVenueType :: !(Maybe ExecutionVenueType),
    quoteRequestLastCapacity :: !(Maybe LastCapacity),
    quoteRequestDayCount :: !(Maybe DayCount),
    quoteRequestFixingReference :: !(Maybe FixingReference),
    quoteRequestAvgPxPrecision :: !(Maybe AvgPxPrecision),
    quoteRequestExpireTime :: !(Maybe ExpireTime),
    quoteRequestFiduciary :: !(Maybe Fiduciary),
    quoteRequestOrdType :: !(Maybe OrdType),
    quoteRequestSpotRatePrecision :: !(Maybe SpotRatePrecision),
    quoteRequestForwardRatePrecision :: !(Maybe ForwardRatePrecision),
    quoteRequestForwardPointsPrecision :: !(Maybe ForwardPointsPrecision),
    quoteRequestInterestRatePrecision :: !(Maybe InterestRatePrecision),
    quoteRequestNearLegRatePrecision :: !(Maybe NearLegRatePrecision),
    quoteRequestFarLegRatePrecision :: !(Maybe FarLegRatePrecision),
    quoteRequestQuoteRequestCustomFieldsGroup :: ![QuoteRequestCustomFieldsGroupElem]
  }
  deriving stock (Show, Eq, Generic)

instance Validity QuoteRequest

instance IsComponent QuoteRequest where
  toComponentFields ((QuoteRequest {..})) =
    mconcat
      [ requiredFieldB quoteRequestQuoteReqID,
        requiredGroupB quoteRequestQuoteRequestRelatedSymGroup,
        optionalFieldB quoteRequestRFQReqID,
        optionalFieldB quoteRequestClOrdID,
        optionalFieldB quoteRequestOrderCapacity,
        optionalGroupB quoteRequestQuoteRequestPartiesGroup,
        optionalGroupB quoteRequestQuoteRequestRegulatoryTradeIDsGroup,
        optionalGroupB quoteRequestQuoteRequestOrderAttributesGroup,
        optionalFieldB quoteRequestOptionDate,
        optionalFieldB quoteRequestText,
        optionalFieldB quoteRequestEncodedText,
        optionalFieldB quoteRequestRefSpotDate,
        requiredFieldB quoteRequestProductType,
        optionalFieldB quoteRequestExecutionVenueType,
        optionalFieldB quoteRequestLastCapacity,
        optionalFieldB quoteRequestDayCount,
        optionalFieldB quoteRequestFixingReference,
        optionalFieldB quoteRequestAvgPxPrecision,
        optionalFieldB quoteRequestExpireTime,
        optionalFieldB quoteRequestFiduciary,
        optionalFieldB quoteRequestOrdType,
        optionalFieldB quoteRequestSpotRatePrecision,
        optionalFieldB quoteRequestForwardRatePrecision,
        optionalFieldB quoteRequestForwardPointsPrecision,
        optionalFieldB quoteRequestInterestRatePrecision,
        optionalFieldB quoteRequestNearLegRatePrecision,
        optionalFieldB quoteRequestFarLegRatePrecision,
        optionalGroupB quoteRequestQuoteRequestCustomFieldsGroup
      ]
  fromComponentFields = do
    quoteRequestQuoteReqID <- requiredFieldP
    quoteRequestQuoteRequestRelatedSymGroup <- requiredGroupP
    quoteRequestRFQReqID <- optionalFieldP
    quoteRequestClOrdID <- optionalFieldP
    quoteRequestOrderCapacity <- optionalFieldP
    quoteRequestQuoteRequestPartiesGroup <- optionalGroupP
    quoteRequestQuoteRequestRegulatoryTradeIDsGroup <- optionalGroupP
    quoteRequestQuoteRequestOrderAttributesGroup <- optionalGroupP
    quoteRequestOptionDate <- optionalFieldP
    quoteRequestText <- optionalFieldP
    quoteRequestEncodedText <- optionalFieldP
    quoteRequestRefSpotDate <- optionalFieldP
    quoteRequestProductType <- requiredFieldP
    quoteRequestExecutionVenueType <- optionalFieldP
    quoteRequestLastCapacity <- optionalFieldP
    quoteRequestDayCount <- optionalFieldP
    quoteRequestFixingReference <- optionalFieldP
    quoteRequestAvgPxPrecision <- optionalFieldP
    quoteRequestExpireTime <- optionalFieldP
    quoteRequestFiduciary <- optionalFieldP
    quoteRequestOrdType <- optionalFieldP
    quoteRequestSpotRatePrecision <- optionalFieldP
    quoteRequestForwardRatePrecision <- optionalFieldP
    quoteRequestForwardPointsPrecision <- optionalFieldP
    quoteRequestInterestRatePrecision <- optionalFieldP
    quoteRequestNearLegRatePrecision <- optionalFieldP
    quoteRequestFarLegRatePrecision <- optionalFieldP
    quoteRequestQuoteRequestCustomFieldsGroup <- optionalGroupP
    pure (QuoteRequest {..})

instance IsMessage QuoteRequest where
  messageType Proxy = MsgTypeQuoteRequest

makeQuoteRequest :: QuoteReqID -> (NonEmpty QuoteRequestRelatedSymGroupElem -> (ProductType -> QuoteRequest))
makeQuoteRequest quoteRequestQuoteReqID quoteRequestQuoteRequestRelatedSymGroup quoteRequestProductType =
  let quoteRequestRFQReqID = Nothing
      quoteRequestClOrdID = Nothing
      quoteRequestOrderCapacity = Nothing
      quoteRequestQuoteRequestPartiesGroup = []
      quoteRequestQuoteRequestRegulatoryTradeIDsGroup = []
      quoteRequestQuoteRequestOrderAttributesGroup = []
      quoteRequestOptionDate = Nothing
      quoteRequestText = Nothing
      quoteRequestEncodedText = Nothing
      quoteRequestRefSpotDate = Nothing
      quoteRequestExecutionVenueType = Nothing
      quoteRequestLastCapacity = Nothing
      quoteRequestDayCount = Nothing
      quoteRequestFixingReference = Nothing
      quoteRequestAvgPxPrecision = Nothing
      quoteRequestExpireTime = Nothing
      quoteRequestFiduciary = Nothing
      quoteRequestOrdType = Nothing
      quoteRequestSpotRatePrecision = Nothing
      quoteRequestForwardRatePrecision = Nothing
      quoteRequestForwardPointsPrecision = Nothing
      quoteRequestInterestRatePrecision = Nothing
      quoteRequestNearLegRatePrecision = Nothing
      quoteRequestFarLegRatePrecision = Nothing
      quoteRequestQuoteRequestCustomFieldsGroup = []
   in (QuoteRequest {..})
