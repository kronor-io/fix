{-# LANGUAGE DeriveGeneric #-}
{-# LANGUAGE DerivingStrategies #-}
{-# LANGUAGE MultiParamTypeClasses #-}
{-# LANGUAGE RecordWildCards #-}
{-# OPTIONS_GHC -Wno-unused-imports #-}

-- | This module has been GENERATED by fix-codegen.
-- Any manual edits will be undone the next time fix-codegen is run.
module FIX.Messages.QuoteRequest where

import Data.List.NonEmpty (NonEmpty)
import Data.Proxy
import Data.Validity
import FIX.Components.Class
import FIX.Fields.ClOrdID
import FIX.Fields.EncodedText
import FIX.Fields.MsgType
import FIX.Fields.OrderCapacity
import FIX.Fields.QuoteReqID
import FIX.Fields.RFQReqID
import FIX.Fields.Text
import FIX.Groups.Class
import FIX.Groups.QuotReqGrpGroupElem
import FIX.Messages.Class
import GHC.Generics (Generic)

-- | MessageSpec
--   { messageName = "QuoteRequest"
--   , messageType = "R"
--   , messageCategory = "app"
--   , messagePieces =
--       [ MessagePieceField "QuoteReqID" True
--       , MessagePieceField "RFQReqID" False
--       , MessagePieceField "ClOrdID" False
--       , MessagePieceField "OrderCapacity" False
--       , MessagePieceGroup
--           GroupSpec
--             { groupName = "QuotReqGrp"
--             , groupNumberField = "NoRelatedSym"
--             , groupPieces =
--                 [ MessagePieceComponent "Instrument" True
--                 , MessagePieceComponent "FinancingDetails" True
--                 , MessagePieceGroup
--                     GroupSpec
--                       { groupName = "UndInstrmtGrp"
--                       , groupNumberField = "NoUnderlyings"
--                       , groupPieces =
--                           [ MessagePieceComponent "UnderlyingInstrument" True ]
--                       }
--                     False
--                 , MessagePieceField "PrevClosePx" False
--                 , MessagePieceField "QuoteRequestType" False
--                 , MessagePieceField "QuoteType" False
--                 , MessagePieceField "TradingSessionID" False
--                 , MessagePieceField "TradingSessionSubID" False
--                 , MessagePieceField "TradeOriginationDate" False
--                 , MessagePieceField "Side" False
--                 , MessagePieceField "QtyType" False
--                 , MessagePieceComponent "OrderQtyData" True
--                 , MessagePieceField "SettlType" False
--                 , MessagePieceField "SettlDate" False
--                 , MessagePieceField "SettlDate2" False
--                 , MessagePieceField "OrderQty2" False
--                 , MessagePieceField "Currency" False
--                 , MessagePieceGroup
--                     GroupSpec
--                       { groupName = "Stipulations"
--                       , groupNumberField = "NoStipulations"
--                       , groupPieces =
--                           [ MessagePieceField "StipulationType" True
--                           , MessagePieceField "StipulationValue" False
--                           ]
--                       }
--                     False
--                 , MessagePieceField "Account" False
--                 , MessagePieceField "AcctIDSource" False
--                 , MessagePieceField "AccountType" False
--                 , MessagePieceGroup
--                     GroupSpec
--                       { groupName = "QuotReqLegsGrp"
--                       , groupNumberField = "NoLegs"
--                       , groupPieces =
--                           [ MessagePieceComponent "InstrumentLeg" True
--                           , MessagePieceField "LegQty" False
--                           , MessagePieceField "LegSwapType" False
--                           , MessagePieceField "LegSettlType" False
--                           , MessagePieceField "LegSettlDate" False
--                           , MessagePieceGroup
--                               GroupSpec
--                                 { groupName = "LegStipulations"
--                                 , groupNumberField = "NoLegStipulations"
--                                 , groupPieces =
--                                     [ MessagePieceField "LegStipulationType" True
--                                     , MessagePieceField "LegStipulationValue" False
--                                     ]
--                                 }
--                               False
--                           , MessagePieceGroup
--                               GroupSpec
--                                 { groupName = "NestedParties"
--                                 , groupNumberField = "NoNestedPartyIDs"
--                                 , groupPieces =
--                                     [ MessagePieceField "NestedPartyID" True
--                                     , MessagePieceField "NestedPartyIDSource" False
--                                     , MessagePieceField "NestedPartyRole" False
--                                     , MessagePieceGroup
--                                         GroupSpec
--                                           { groupName = "NstdPtysSubGrp"
--                                           , groupNumberField = "NoNestedPartySubIDs"
--                                           , groupPieces =
--                                               [ MessagePieceField "NestedPartySubID" True
--                                               , MessagePieceField "NestedPartySubIDType" False
--                                               ]
--                                           }
--                                         False
--                                     ]
--                                 }
--                               False
--                           , MessagePieceComponent "LegBenchmarkCurveData" True
--                           ]
--                       }
--                     False
--                 , MessagePieceGroup
--                     GroupSpec
--                       { groupName = "QuotQualGrp"
--                       , groupNumberField = "NoQuoteQualifiers"
--                       , groupPieces = [ MessagePieceField "QuoteQualifier" True ]
--                       }
--                     False
--                 , MessagePieceField "QuotePriceType" False
--                 , MessagePieceField "OrdType" False
--                 , MessagePieceField "ValidUntilTime" False
--                 , MessagePieceField "ExpireTime" False
--                 , MessagePieceField "TransactTime" False
--                 , MessagePieceComponent "SpreadOrBenchmarkCurveData" True
--                 , MessagePieceField "PriceType" False
--                 , MessagePieceField "Price" False
--                 , MessagePieceField "Price2" False
--                 , MessagePieceComponent "YieldData" True
--                 , MessagePieceGroup
--                     GroupSpec
--                       { groupName = "Parties"
--                       , groupNumberField = "NoPartyIDs"
--                       , groupPieces =
--                           [ MessagePieceField "PartyID" True
--                           , MessagePieceField "PartyIDSource" False
--                           , MessagePieceField "PartyRole" False
--                           , MessagePieceGroup
--                               GroupSpec
--                                 { groupName = "PtysSubGrp"
--                                 , groupNumberField = "NoPartySubIDs"
--                                 , groupPieces =
--                                     [ MessagePieceField "PartySubID" True
--                                     , MessagePieceField "PartySubIDType" False
--                                     ]
--                                 }
--                               False
--                           ]
--                       }
--                     False
--                 ]
--             }
--           True
--       , MessagePieceField "Text" False
--       , MessagePieceField "EncodedText" False
--       ]
--   }
data QuoteRequest = QuoteRequest
  { quoteRequestQuoteReqID :: !QuoteReqID,
    quoteRequestRFQReqID :: !(Maybe RFQReqID),
    quoteRequestClOrdID :: !(Maybe ClOrdID),
    quoteRequestOrderCapacity :: !(Maybe OrderCapacity),
    quoteRequestQuotReqGrpGroup :: !(NonEmpty QuotReqGrpGroupElem),
    quoteRequestText :: !(Maybe Text),
    quoteRequestEncodedText :: !(Maybe EncodedText)
  }
  deriving stock (Show, Eq, Generic)

instance Validity QuoteRequest

instance IsComponent QuoteRequest where
  toComponentFields ((QuoteRequest {..})) =
    mconcat
      [ requiredFieldB quoteRequestQuoteReqID,
        optionalFieldB quoteRequestRFQReqID,
        optionalFieldB quoteRequestClOrdID,
        optionalFieldB quoteRequestOrderCapacity,
        requiredGroupB quoteRequestQuotReqGrpGroup,
        optionalFieldB quoteRequestText,
        optionalFieldB quoteRequestEncodedText
      ]
  fromComponentFields = do
    quoteRequestQuoteReqID <- requiredFieldP
    quoteRequestRFQReqID <- optionalFieldP
    quoteRequestClOrdID <- optionalFieldP
    quoteRequestOrderCapacity <- optionalFieldP
    quoteRequestQuotReqGrpGroup <- requiredGroupP
    quoteRequestText <- optionalFieldP
    quoteRequestEncodedText <- optionalFieldP
    pure (QuoteRequest {..})

instance IsMessage QuoteRequest where
  messageType Proxy = MsgTypeQuoteRequest
