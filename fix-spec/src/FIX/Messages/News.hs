{-# LANGUAGE DeriveGeneric #-}
{-# LANGUAGE DerivingStrategies #-}
{-# LANGUAGE MultiParamTypeClasses #-}
{-# LANGUAGE RecordWildCards #-}
{-# OPTIONS_GHC -Wno-unused-imports #-}

-- | This module has been GENERATED by fix-codegen.
-- Any manual edits will be undone the next time fix-codegen is run.
module FIX.Messages.News where

import Data.List.NonEmpty (NonEmpty)
import Data.Proxy
import Data.Validity
import FIX.Components.Class
import FIX.Fields.Headline
import FIX.Fields.MsgType
import FIX.Groups.Class
import FIX.Groups.LinesOfTextGroupElem
import FIX.Groups.RoutingIDsGroupElem
import FIX.Messages.Class
import GHC.Generics (Generic)

-- | MessageSpec
--   { messageName = "News"
--   , messageType = "B"
--   , messageCategory = "app"
--   , messagePieces =
--       [ MessagePieceField "Headline" True
--       , MessagePieceGroup
--           GroupSpec
--             { groupName = "NoLinesOfText"
--             , groupNumberField = "NoLinesOfText"
--             , groupPieces = [ MessagePieceField "Text" True ]
--             }
--           True
--       , MessagePieceGroup
--           GroupSpec
--             { groupName = "NoRoutingIDs"
--             , groupNumberField = "NoRoutingIDs"
--             , groupPieces =
--                 [ MessagePieceField "RoutingType" True
--                 , MessagePieceField "RoutingID" False
--                 ]
--             }
--           False
--       ]
--   }
data News = News
  { newsHeadline :: !Headline,
    newsLinesOfTextGroup :: !(NonEmpty LinesOfTextGroupElem),
    newsRoutingIDsGroup :: ![RoutingIDsGroupElem]
  }
  deriving stock (Show, Eq, Generic)

instance Validity News

instance IsComponent News where
  toComponentFields ((News {..})) =
    mconcat
      [ requiredFieldB newsHeadline,
        requiredGroupB newsLinesOfTextGroup,
        optionalGroupB newsRoutingIDsGroup
      ]
  fromComponentFields = do
    newsHeadline <- requiredFieldP
    newsLinesOfTextGroup <- requiredGroupP
    newsRoutingIDsGroup <- optionalGroupP
    pure (News {..})

instance IsMessage News where
  messageType Proxy = MsgTypeNews

makeNews :: Headline -> (NonEmpty LinesOfTextGroupElem -> News)
makeNews newsHeadline newsLinesOfTextGroup =
  let newsRoutingIDsGroup = []
   in (News {..})
