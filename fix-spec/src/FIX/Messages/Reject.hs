{-# LANGUAGE DeriveGeneric #-}
{-# LANGUAGE DerivingStrategies #-}
{-# LANGUAGE MultiParamTypeClasses #-}
{-# LANGUAGE RecordWildCards #-}
{-# OPTIONS_GHC -Wno-unused-imports #-}

-- | This module has been GENERATED by fix-codegen.
-- Any manual edits will be undone the next time fix-codegen is run.
module FIX.Messages.Reject where

import Data.List.NonEmpty (NonEmpty)
import Data.Proxy
import Data.Validity
import FIX.Components.Class
import FIX.Fields.MsgType
import FIX.Fields.RefMsgType
import FIX.Fields.RefSeqNum
import FIX.Fields.RefTagID
import FIX.Fields.SessionRejectReason
import FIX.Fields.Text
import FIX.Groups.Class
import FIX.Messages.Class
import GHC.Generics (Generic)

-- | MessageSpec
--   { messageName = "Reject"
--   , messageType = "3"
--   , messageCategory = "admin"
--   , messagePieces =
--       [ MessagePieceField "RefSeqNum" True
--       , MessagePieceField "Text" False
--       , MessagePieceField "RefTagID" False
--       , MessagePieceField "RefMsgType" False
--       , MessagePieceField "SessionRejectReason" False
--       ]
--   }
data Reject = Reject
  { rejectRefSeqNum :: !RefSeqNum,
    rejectText :: !(Maybe Text),
    rejectRefTagID :: !(Maybe RefTagID),
    rejectRefMsgType :: !(Maybe RefMsgType),
    rejectSessionRejectReason :: !(Maybe SessionRejectReason)
  }
  deriving stock (Show, Eq, Generic)

instance Validity Reject

instance IsComponent Reject where
  toComponentFields ((Reject {..})) =
    mconcat
      [ requiredFieldB rejectRefSeqNum,
        optionalFieldB rejectText,
        optionalFieldB rejectRefTagID,
        optionalFieldB rejectRefMsgType,
        optionalFieldB rejectSessionRejectReason
      ]
  fromComponentFields = do
    rejectRefSeqNum <- requiredFieldP
    rejectText <- optionalFieldP
    rejectRefTagID <- optionalFieldP
    rejectRefMsgType <- optionalFieldP
    rejectSessionRejectReason <- optionalFieldP
    pure (Reject {..})

instance IsMessage Reject where
  messageType Proxy = MsgTypeReject

makeReject :: RefSeqNum -> Reject
makeReject rejectRefSeqNum =
  let rejectText = Nothing
      rejectRefTagID = Nothing
      rejectRefMsgType = Nothing
      rejectSessionRejectReason = Nothing
   in (Reject {..})
