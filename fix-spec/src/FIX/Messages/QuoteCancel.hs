{-# LANGUAGE DeriveGeneric #-}
{-# LANGUAGE DerivingStrategies #-}
{-# LANGUAGE MultiParamTypeClasses #-}
{-# LANGUAGE RecordWildCards #-}
{-# OPTIONS_GHC -Wno-unused-imports #-}

-- | This module has been GENERATED by fix-codegen.
-- Any manual edits will be undone the next time fix-codegen is run.
module FIX.Messages.QuoteCancel where

import Data.List.NonEmpty (NonEmpty)
import Data.Proxy
import Data.Validity
import FIX.Components.Class
import FIX.Fields.Account
import FIX.Fields.AccountType
import FIX.Fields.AcctIDSource
import FIX.Fields.MsgType
import FIX.Fields.ProductType
import FIX.Fields.QuoteCancelType
import FIX.Fields.QuoteID
import FIX.Fields.QuoteReqID
import FIX.Fields.QuoteResponseLevel
import FIX.Fields.TradingSessionID
import FIX.Fields.TradingSessionSubID
import FIX.Fields.Username
import FIX.Groups.Class
import FIX.Groups.PartiesGroupElem
import FIX.Groups.QuoteEntriesGroupElem
import FIX.Messages.Class
import GHC.Generics (Generic)

-- | MessageSpec
--   { messageName = "QuoteCancel"
--   , messageType = "Z"
--   , messageCategory = "app"
--   , messagePieces =
--       [ MessagePieceField "QuoteReqID" False
--       , MessagePieceField "QuoteID" True
--       , MessagePieceField "QuoteCancelType" True
--       , MessagePieceField "QuoteResponseLevel" False
--       , MessagePieceGroup
--           GroupSpec
--             { groupName = "Parties"
--             , groupNumberField = "NoPartyIDs"
--             , groupPieces =
--                 [ MessagePieceField "PartyID" True
--                 , MessagePieceField "PartyIDSource" False
--                 , MessagePieceField "PartyRole" False
--                 , MessagePieceField "PartyRoleQualifier" False
--                 , MessagePieceGroup
--                     GroupSpec
--                       { groupName = "PartySubIDs"
--                       , groupNumberField = "NoPartySubIDs"
--                       , groupPieces =
--                           [ MessagePieceField "PartySubID" True
--                           , MessagePieceField "PartySubIDType" False
--                           ]
--                       }
--                     False
--                 ]
--             }
--           False
--       , MessagePieceField "Account" False
--       , MessagePieceField "Username" False
--       , MessagePieceField "ProductType" False
--       , MessagePieceField "AcctIDSource" False
--       , MessagePieceField "AccountType" False
--       , MessagePieceField "TradingSessionID" False
--       , MessagePieceField "TradingSessionSubID" False
--       , MessagePieceGroup
--           GroupSpec
--             { groupName = "QuoteEntries"
--             , groupNumberField = "NoQuoteEntries"
--             , groupPieces =
--                 [ MessagePieceComponent "Instrument" True
--                 , MessagePieceComponent "FinancingDetails" True
--                 , MessagePieceGroup
--                     GroupSpec
--                       { groupName = "Underlyings"
--                       , groupNumberField = "NoUnderlyings"
--                       , groupPieces =
--                           [ MessagePieceComponent "UnderlyingInstrument" True ]
--                       }
--                     False
--                 , MessagePieceGroup
--                     GroupSpec
--                       { groupName = "Legs"
--                       , groupNumberField = "NoLegs"
--                       , groupPieces = [ MessagePieceComponent "InstrumentLeg" True ]
--                       }
--                     False
--                 ]
--             }
--           False
--       ]
--   }
data QuoteCancel = QuoteCancel
  { quoteCancelQuoteReqID :: !(Maybe QuoteReqID),
    quoteCancelQuoteID :: !QuoteID,
    quoteCancelQuoteCancelType :: !QuoteCancelType,
    quoteCancelQuoteResponseLevel :: !(Maybe QuoteResponseLevel),
    quoteCancelPartiesGroup :: ![PartiesGroupElem],
    quoteCancelAccount :: !(Maybe Account),
    quoteCancelUsername :: !(Maybe Username),
    quoteCancelProductType :: !(Maybe ProductType),
    quoteCancelAcctIDSource :: !(Maybe AcctIDSource),
    quoteCancelAccountType :: !(Maybe AccountType),
    quoteCancelTradingSessionID :: !(Maybe TradingSessionID),
    quoteCancelTradingSessionSubID :: !(Maybe TradingSessionSubID),
    quoteCancelQuoteEntriesGroup :: ![QuoteEntriesGroupElem]
  }
  deriving stock (Show, Eq, Generic)

instance Validity QuoteCancel

instance IsComponent QuoteCancel where
  toComponentFields ((QuoteCancel {..})) =
    mconcat
      [ optionalFieldB quoteCancelQuoteReqID,
        requiredFieldB quoteCancelQuoteID,
        requiredFieldB quoteCancelQuoteCancelType,
        optionalFieldB quoteCancelQuoteResponseLevel,
        optionalGroupB quoteCancelPartiesGroup,
        optionalFieldB quoteCancelAccount,
        optionalFieldB quoteCancelUsername,
        optionalFieldB quoteCancelProductType,
        optionalFieldB quoteCancelAcctIDSource,
        optionalFieldB quoteCancelAccountType,
        optionalFieldB quoteCancelTradingSessionID,
        optionalFieldB quoteCancelTradingSessionSubID,
        optionalGroupB quoteCancelQuoteEntriesGroup
      ]
  fromComponentFields = do
    quoteCancelQuoteReqID <- optionalFieldP
    quoteCancelQuoteID <- requiredFieldP
    quoteCancelQuoteCancelType <- requiredFieldP
    quoteCancelQuoteResponseLevel <- optionalFieldP
    quoteCancelPartiesGroup <- optionalGroupP
    quoteCancelAccount <- optionalFieldP
    quoteCancelUsername <- optionalFieldP
    quoteCancelProductType <- optionalFieldP
    quoteCancelAcctIDSource <- optionalFieldP
    quoteCancelAccountType <- optionalFieldP
    quoteCancelTradingSessionID <- optionalFieldP
    quoteCancelTradingSessionSubID <- optionalFieldP
    quoteCancelQuoteEntriesGroup <- optionalGroupP
    pure (QuoteCancel {..})

instance IsMessage QuoteCancel where
  messageType Proxy = MsgTypeQuoteCancel

makeQuoteCancel :: QuoteID -> (QuoteCancelType -> QuoteCancel)
makeQuoteCancel quoteCancelQuoteID quoteCancelQuoteCancelType =
  let quoteCancelQuoteReqID = Nothing
      quoteCancelQuoteResponseLevel = Nothing
      quoteCancelPartiesGroup = []
      quoteCancelAccount = Nothing
      quoteCancelUsername = Nothing
      quoteCancelProductType = Nothing
      quoteCancelAcctIDSource = Nothing
      quoteCancelAccountType = Nothing
      quoteCancelTradingSessionID = Nothing
      quoteCancelTradingSessionSubID = Nothing
      quoteCancelQuoteEntriesGroup = []
   in (QuoteCancel {..})
